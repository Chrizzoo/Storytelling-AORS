<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl" ?>
<SimulationScenario scenarioName="Juveniles1" version="0.9" createSimulationLog="true"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns="http://aor-simulation.org" xmlns:aor="http://aor-simulation.org"
	xsi:schemaLocation="http://aor-simulation.org distribution/ext/aorsl/AORSL_0-9.xsd ">
	<SimulationParameters createDebuggingOutput="true" simulationSteps="1000" />
	<SimulationModel modelName="Juveniles1" modelTitle="Juveniles Scenario 1">
		<documentation>
			<dc:creator>Rene Groothedde</dc:creator>
			<dc:created>20130805</dc:created>
			<dc:contributor>Chris Broekema</dc:contributor>
		</documentation>
		<!-- ========================== -->
		<DataTypes>
			<aor:Enumeration name="ConflictStrategy">
				<aor:EnumerationLiteral displayString="Competitive">COMPETITIVE</aor:EnumerationLiteral>
				<aor:EnumerationLiteral displayString="Avoiding">AVOIDING</aor:EnumerationLiteral>
				<aor:EnumerationLiteral displayString="Collaborating">COLLABORATING</aor:EnumerationLiteral>
				<aor:EnumerationLiteral displayString="Accomodating">ACCOMODATING</aor:EnumerationLiteral>
			</aor:Enumeration>
			<ComplexDataType name="MessageContent"></ComplexDataType>
		</DataTypes>
		<!-- ========================== -->
		<Globals>
			<GlobalVariable name="POLICE_ID" dataType="Integer" initialValue="1" />
			<GlobalVariable name="JUVENILE_ID" dataType="Integer" initialValue="2" />

			<GlobalVariable name="USE_INPUT" dataType="Integer" initialValue="10" />
			<GlobalVariable name="ONLY_PERSONALITY" dataType="Integer" initialValue="11" />
			<GlobalVariable name="ONLY_COMPLEMENTING" dataType="Integer" initialValue="12" />
			<GlobalVariable name="FULL_MODEL" dataType="Integer" initialValue="13" />
			
			<aor:GlobalVariable name="REACTION_DELAY" dataType="Integer" initialValue="30" />
			<!-- ========================== -->
			<GlobalVariable name="MessageLogString" dataType="String" initialValue=""></GlobalVariable>
			<!-- ========================== -->
			<GlobalFunction resultType="String" name="getAppendedLog">
				<aor:documentation>Append the message to the messagelog. Print the message in the simconsole. Return the last 100 characters.</aor:documentation>
				<Parameter name="message" type="String" />
				<Body language="Java">
				string result = Global.MessageLogString + "; " + message;
				result = result.substring(result.length()-100);
				simConsole.message(message);
				return result;
				</Body>
				<Body language="JavaScript">
				var result = Global.MessageLogString + "; " + message;
				var maxlength = 120;
				if (result.length > maxlength){
					result = "..."+ result.substring(result.length - maxlength);}
				simConsole.message(message);
				return result;
				</Body>
			</GlobalFunction>
			<aor:GlobalFunction resultType="Integer" name="getAssertiveness">
				<aor:Parameter name="strategy" type="ConflictStrategy"/>
			   <aor:Body language="Java JavaScript">
			     <![CDATA[
                  var result = 0;
                  switch(strategy) {
                      case( ConflictStrategy.COMPETITIVE): {   
                      		result =  1
                          	break;
                      }
                      case( ConflictStrategy.AVOIDING): {
                         	result = 0
                         	break;
                      }
                      case( ConflictStrategy.COLLABORATING): {
                          	result =  1
                          	break;
                      }
                      case ( ConflictStrategy.ACCOMODATING ): {
                         	result =  0
                         	break;
                      }
                      default: {
                      	result = -1;
                      	break;}
                  }
                  return result;
			   ]]>
			   </aor:Body>
			</aor:GlobalFunction>
			<aor:GlobalFunction resultType="Integer" name="getCooperativeness">
				<aor:Parameter name="strategy" type="ConflictStrategy"/>
			   <aor:Body language="Java JavaScript">
			     <![CDATA[
                  var result = 0;
                  switch(strategy) {
                      case( ConflictStrategy.COMPETITIVE): {   
                      		result =  0
                          	break;
                      }
                      case( ConflictStrategy.AVOIDING): {
                         	result = 0
                         	break;
                      }
                      case( ConflictStrategy.COLLABORATING): {
                          	result =  1
                          	break;
                      }
                      case ( ConflictStrategy.ACCOMODATING ): {
                         	result =  1
                         	break;
                      }
                      default: {
                      	result = -1;
                      	break;}
                  }
                  return result;
			   ]]>
			   </aor:Body>
			</aor:GlobalFunction>
			<aor:GlobalFunction resultType="Integer" name="getComplementingStrategy">
				<aor:Parameter name="strategy" type="ConflictStrategy"/>
			   <aor:Body language="Java JavaScript">
			     <![CDATA[
                  var result = ConflictStrategy.AVOIDING;
                  
				  if (strategy === ConflictStrategy.AVOIDING) {
				  	  result = ConflictStrategy.COMPETITIVE;
				  }
				  else if (strategy === ConflictStrategy.COLLABORATING) {
				  	 result = ConflictStrategy.ACCOMODATING;
				  }
				  else if (strategy === ConflictStrategy.ACCOMODATING) {
				  	 result = ConflictStrategy.COLLABORATING;
				  }
                  return result;
			   ]]>
			   </aor:Body>
			</aor:GlobalFunction>			
		</Globals>
		<!-- ========================== -->
		<EntityTypes>
			<!-- ========================== -->
			<MessageType name="Tell">
				<aor:documentation>
				Message that contains a reference to the person that sends it and the action that it choose.
				</aor:documentation>
				<aor:ReferenceProperty name="sender" type="Person" />
				<aor:ReferenceProperty name="choosenAction" type="ActionChoice" />
				<!-- ========================== -->
				<Function resultType="String" name="toString">
					<Body language="Java JavaScript">return this.getSender().getName() + ":\""+ this.getChoosenAction().getDisplayText()+ "\"";</Body>
				</Function>
				<!-- ========================== -->
				<Function resultType="boolean" name="contentEquals">
					<Parameter name="msg" type="String" />
					<Body language="Java">return this.getContent().equals(msg);</Body>
					<Body language="JavaScript">return this.getContent() == msg; </Body>
				</Function>
				<!-- ========================== -->
			</MessageType>
			<CausedEventType name="StartSim" />
			<!-- ========================== -->
			<CausedEventType name="AskInput" />

			<!-- ========================== -->
			<ActionEventType name="AddLogMessage">
				<Attribute name="msg" type="String" />
			</ActionEventType>
			<!-- ========================== -->
			<AgentType memorySize="25" name="Person">
			 
				<Attribute name="character" type="String" />
				
				<!-- The settings the character uses: useInput, onlyPersonality, onlyComplementing, fulModel -->
				<Attribute name="characterType" type="Integer" />
				
				<!-- The last message this character has sent -->
				<Attribute name="lastMessage" type="String" initialValue="" />
				
				<!-- The last input Choice for a character that uses input mode -->
				<aor:Attribute name="lastInputChoice" type="String" />
				
				<!-- whether or not the next action of the agent needs to be calculated -->
				<Attribute name="needsActionCalculation" type="Boolean" initialValue="false" />
				<Attribute name="actionNeeded" type="Boolean" initialValue="false" />
				<aor:Attribute name="receiverID" type="Integer" initialValue="0" />
				<!-- ========================== -->
				
				<!-- self -->
				<!-- the strategy that the character currently has -->
				<aor:EnumerationProperty name="currentStrategy" type="ConflictStrategy" />
				
				<!-- the strategy that the character has according to his personality -->
				<aor:EnumerationProperty name="personalityStrategy" type="ConflictStrategy" />
				
				<!-- the mood that the character currently has -->
				<aor:Attribute name="currentMood" type="Integer" initialValue="0" />
				
				<!-- the strategy that the character has chosen based on its intentions -->
				<aor:EnumerationProperty name="activePursuitStrategy" type="ConflictStrategy" />
				
				<!-- values for calculating next action. -->
				<aor:Attribute name="bestUtilityValue" type="Integer" initialValue="0"/>
				<aor:ReferenceProperty name="nextAction" type="ActionChoice" />
				
				<!-- other (conversational partner) -->
				<aor:EnumerationProperty name="otherStrategy" type="ConflictStrategy" />
				<aor:ReferenceProperty name="otherAction" type="ActionChoice" />
				
				<!-- ========================== -->
				
				<aor:Function resultType="Integer" name="ProcessIncomingMessage"  >
					<aor:Parameter name="message" type="Message"/>
					<aor:Body language="Java JavaScript">
					<![CDATA[
					
						// reset best utility for the respons action that will be chosen.	
						this.setBestUtilityValue(0); 
					
						this.setOtherAction(message.choosenAction);
						this.setOtherStrategy(this.getOtherAction().getStrategy());
						
						/* Change the Mood acording to the action of the other! */
						this.setCurrentMood(this.getCurrentMood() + this.getOtherAction().getOtherMoodBelief());
						
						// update the message for the mood.
						var nextAction = this.getNextAction();
						this.setLastMessage(nextAction == null ? "": nextAction.getDisplayText() + " ( Mood: "+ this.getCurrentMood() + " )");
						
						/* Some Debug outputs					
						simConsole.message(this.getOtherAction().toString());
						simConsole.message("my A: "+Global.getAssertiveness(this.getCurrentStrategy()));
						simConsole.message("my C: "+Global.getCooperativeness(this.getCurrentStrategy()));
						
						simConsole.message("his A: "+Global.getAssertiveness(this.getOtherStrategy()));
						simConsole.message("his C: "+Global.getCooperativeness(this.getOtherStrategy()));
						simConsole.message(this.getName()+" :"+this.getCurrentMood());
						*/
						]]>	
					</aor:Body>
				</aor:Function>
				<aor:Function resultType="Integer" name="calculateUtilityValue">
					<aor:Parameter name="action" type="ActionChoice"/>
					<aor:Body language="JavaScript">
					<![CDATA[							
							var currentUtility = 0;
							var charType = this.getCharacterType();

							
							var comparePersonality = function(util, myStrategy, actionStrategy) {
								var my_a =	Global.getAssertiveness(myStrategy);
								var my_c =	Global.getCooperativeness(myStrategy);
								var action_a = Global.getAssertiveness(actionStrategy);
								var action_c = Global.getCooperativeness(actionStrategy);
								if (my_a == action_a) {
									util = util +5;
								}
								if (my_c == action_c) {
									util = util +5;
								}
								return util;
							}
							
							var complementingStrategy = function(util, otherStrategy, actionStrategy) {
								var action_a = Global.getAssertiveness(actionStrategy);
								var action_c = Global.getCooperativeness(actionStrategy);
								var other_a = Global.getAssertiveness(otherStrategy);
								var other_c = Global.getCooperativeness(otherStrategy);

								if (other_a != action_a) {
									util = util +5;
								}
								if (other_c == action_c) {
									util = util +5;
								}
								
								return util;
							}
							
							var activePursuitStrategy = function(util, apsStrategy, actionStrategy) {
								var action_a = Global.getAssertiveness(actionStrategy);
								var action_c = Global.getCooperativeness(actionStrategy);
								var my_aps_a = Global.getAssertiveness(apsStrategy);
								var my_aps_c = Global.getCooperativeness(apsStrategy);

								if (my_aps_a == action_a) {
									util = util +5;
								}
								if (my_aps_c == action_c) {
									util = util +5;
								}
								
								return util;
							}
							
							
							if (charType == Global.ONLY_PERSONALITY) {						
								currentUtility = comparePersonality(currentUtility, this.getPersonalityStrategy(), action.getStrategy());
							}
							else {
								if (charType == Global.ONLY_COMPLEMENTING) {
									currentUtility = complementingStrategy(currentUtility, this.getOtherAction().getStrategy(), action.getStrategy());

								}
								else if (charType == Global.FULL_MODEL) {
									currentUtility = comparePersonality(currentUtility, this.getPersonalityStrategy(), action.getStrategy());
									currentUtility = complementingStrategy(currentUtility, this.getOtherAction().getStrategy(), action.getStrategy());
									currentUtility = activePursuitStrategy(currentUtility, this.getActivePursuitStrategy(), action.getStrategy());					
								}
							}
							
							//var matchingMood = this.getCurrentMood() == action.getMood() ? 100 : 0;
							//currentUtility = currentUtility + matchingMood;
							
							var differenceFunc = function foo(num1, num2){
 								return (num1 > num2)? num1-num2 : num2-num1
							}
							
							currentUtility = currentUtility + 200 - differenceFunc(action.getMood(), this.getCurrentMood());
							
							

								
							if (currentUtility > this.getBestUtilityValue()) {
								this.setBestUtilityValue(currentUtility);
							}
							
							/* Some debug outputs
							simConsole.message("Utility: "+currentUtility);
							simConsole.message("Action: "+action);	
							simConsole.message("bestUtil: "+this.getBestUtilityValue());
							*/
						
						return currentUtility;
					]]>	
					</aor:Body>
				</aor:Function>
				<aor:Function resultType="Integer" name="selectFittingAction" >
				<aor:Parameter name="strategy" type="String"/>
					<aor:Body language="JavaScript">
					<![CDATA[					      
					      var selectedStrategy = 0;
		                  switch(parseInt(strategy)) {
		                      case(1): {   
		                      		selectedStrategy =  ConflictStrategy.COMPETITIVE
		                          	break;
		                      }
		                      case(2): {
		                         	selectedStrategy = ConflictStrategy.AVOIDING
		                         	break;
		                      }
		                      case(3): {
		                          	selectedStrategy =  ConflictStrategy.COLLABORATING
		                          	break;
		                      }
		                      default: {
		                      	selectedStrategy = ConflictStrategy.ACCOMODATING;
		                      	break;}
		                  }
		                  
						var myMood = this.getCurrentMood();
						var myCharacter = this.getCharacter();
						
						bestAction = 0;
						bestUtility = 0;
						
						var differenceFunc = function foo(num1, num2){
 							 return (num1 > num2)? num1-num2 : num2-num1
						}
						
						var possibleActions = Simulator.envSim.getObjectsByType("ActionChoice");
						var size = possibleActions.size();
						for (var i = 0; i < size ; i++) {
							var action = possibleActions.get(i);
							if (action.getCharacter() == myCharacter) {
								if (action.getStrategy() == selectedStrategy) {
									util = 200 - differenceFunc(action.getMood(), myMood);
									if (util > bestUtility) {
										bestAction = action.getId();
										bestUtility = util;
									}
								}
							}
							
						}	
						return bestAction;
					]]>	
					</aor:Body>
				</aor:Function>
								
				<!-- ========================== -->
				<aor:ReactionRule name="PerformActionRule" agentVariable="agt">
					<aor:ON-EACH-SIMULATION-STEP />
					<aor:IF language="JavaScript"><![CDATA[!(this.agt.isNeedsActionCalculation()) && this.agt.isActionNeeded() && this.agt.getNextAction() !== null]]></aor:IF>
					<aor:THEN>
						<!-- <aor:DO> -->
						<aor:UPDATE-AGT>
							<aor:Slot property="actionNeeded" value="false" />
							<aor:Slot property="lastMessage">
								<aor:ValueExpr language="Java JavaScript">this.agt.getNextAction().getDisplayText() + " ( Mood: "+ this.agt.getCurrentMood() + " )"</aor:ValueExpr>
							</aor:Slot>
						</aor:UPDATE-AGT>
						<SCHEDULE-EVT>
							<ActionEventExpr actionEventType="AddLogMessage">
								<Slot property="msg">
									<ValueExpr language="Java JavaScript" logPeriodicity="1">this.agt.getName()+ ":\"" +this.agt.getNextAction().getDisplayText() + "\""</ValueExpr>
								</Slot>
							</ActionEventExpr>
							<OutMessageEventExpr messageType="Tell">
								<ReceiverIdRef language="Java JavaScript">this.agt.getReceiverID() </ReceiverIdRef>
								<aor:Delay>
									<aor:GlobalVariableValueExpr variable="REACTION_DELAY" />
								</aor:Delay>
								<Slot property="sender">
									<ValueExpr language="Java JavaScript">this.agt</ValueExpr>
								</Slot>
								<Slot property="choosenAction">
									<ValueExpr language="Java JavaScript">this.agt.getNextAction()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
						<!-- </aor:DO> -->
					</aor:THEN>
				</aor:ReactionRule>
				<!-- =========== --> 
				<!-- ========================== -->			

			</AgentType>
			<!-- ==================================== -->
			<AgentType memorySize="20" name="Police" superType="Person">
				<ReactionRule name="AskInputForPolice" agentVariable="agt">
					<WHEN eventType="InMessageEvent" eventVariable="evtVar" messageType="Tell"
						messageVariable="msg" />
					<DO>
						<aor:UPDATE-AGT>
							<aor:Call contextObjectVariable="agt" procedure="ProcessIncomingMessage">
						 		<aor:Argument parameter="message"><aor:ValueExpr language="Java JavaScript">this.msg</aor:ValueExpr></aor:Argument>
						 </aor:Call>
						</aor:UPDATE-AGT>
						<SCHEDULE-EVT>
							<ActionEventExpr actionEventType="AskInput">
								<aor:Delay>
									<aor:GlobalVariableValueExpr variable="REACTION_DELAY" />
								</aor:Delay>
							</ActionEventExpr>
						</SCHEDULE-EVT>
						
					</DO>
				</ReactionRule>
				<ActionRule name="ProcessInput" agentVariable="agt">
					<RuleParameter name="inputChoice" type="String" />
					<DO>
						<UPDATE-AGT>
							<Slot property="lastInputChoice">
								<ValueExpr logPeriodicity="5" language="Java JavaScript">this.inputChoice</ValueExpr>
							</Slot>
							<aor:Slot property="actionNeeded" value="true" />
							<aor:Slot property="needsActionCalculation" value="true" />
						</UPDATE-AGT>
					</DO>
				</ActionRule>
				

			</AgentType>
			<AgentType memorySize="20" name="Juvenile" superType="Person" >
					<ReactionRule name="UseIncomingMessage" agentVariable="agt">
					<WHEN eventType="InMessageEvent" eventVariable="evt" messageType="Tell" messageVariable="msg" />
					<aor:DO>
						 <aor:UPDATE-AGT>
						 	<aor:Slot property="actionNeeded" value="true" />
							<aor:Slot property="needsActionCalculation" value="true" />
							<aor:Call contextObjectVariable="agt" procedure="ProcessIncomingMessage">
						 		<aor:Argument parameter="message"><aor:ValueExpr language="Java JavaScript">this.msg</aor:ValueExpr></aor:Argument>
						 	</aor:Call>
						</aor:UPDATE-AGT>
					</aor:DO>
				</ReactionRule>
			</AgentType>
			
			<!-- =================================================== -->
			<aor:ObjectType name="ActionChoice">
				<aor:Attribute name="character" type="String" />
				<aor:Attribute name="displayText" type="String" />
				<aor:Attribute name="conversationType" type="String" />
				<aor:Attribute name="mood" type="Integer" />
				<aor:Attribute name="otherMoodBelief" type="Integer"/>
				<aor:EnumerationProperty name="strategy" type="ConflictStrategy" />
				<aor:Function resultType="String" name="toString">
					<Body language="Java JavaScript">return "A:"+Global.getAssertiveness(this.getStrategy())+ " C:"+ Global.getCooperativeness(this.getStrategy())  + ", "+this.getDisplayText() + ", Type: "+ this.getConversationType()+ ", Mood: " + this.getMood() +", OtherMoodBelief: "+ this.getOtherMoodBelief();</Body>
				</aor:Function>
			</aor:ObjectType>
		</EntityTypes>
		<!-- =================================================== -->
		<EnvironmentRules>
			<!-- =================================================== -->
			<EnvironmentRule name="AddLogMessageRule">
				<WHEN eventType="AddLogMessage" eventVariable="evt" />
				<DO>
					<UPDATE-ENV>
						<UpdateGlobalVariable name="MessageLogString">
							<ValueExpr language="Java JavaScript">Global.getAppendedLog(this.evt.getMsg())</ValueExpr>
						</UpdateGlobalVariable>
					</UPDATE-ENV>
				</DO>
			</EnvironmentRule>
			
			<!-- Calculate next action for each juvenile when needed -->
			<aor:EnvironmentRule name="CalculateJuvenilesNextActionsRule">
				<aor:ON-EACH-SIMULATION-STEP />
				<aor:FOR-ObjectVariable variable="juvenile" objectType="Juvenile">
					<aor:SelectionCondition language="Java JavaScript">this.juvenile.needsActionCalculation</aor:SelectionCondition>
				</aor:FOR-ObjectVariable>
				<aor:FOR-ObjectVariable variable="actionChoice" objectType="ActionChoice">
					<aor:SelectionCondition language="JavaScript"><![CDATA[this.juvenile.getCharacter() === this.actionChoice.getCharacter() && this.juvenile.calculateUtilityValue(this.actionChoice) >= this.juvenile.getBestUtilityValue()]]></aor:SelectionCondition>
				</aor:FOR-ObjectVariable>
				<aor:DO>
					<aor:UPDATE-ENV>
						<aor:UpdateObject objectVariable="juvenile">
							<aor:Slot property="nextAction">
								<aor:ObjectValueExpr objectVariable="actionChoice" />
							</aor:Slot>
							<aor:Slot property="needsActionCalculation" value="false" />
						</aor:UpdateObject>
					</aor:UPDATE-ENV>
				</aor:DO>
			</aor:EnvironmentRule>
			<!-- Calculate next action for each juvenile when needed -->
			<aor:EnvironmentRule name="CalculatePoliceNextActionsRule">
				<aor:ON-EACH-SIMULATION-STEP />
				
				<aor:FOR-ObjectVariable variable="police" objectType="Police">
					<aor:SelectionCondition language="Java JavaScript">this.police.needsActionCalculation</aor:SelectionCondition>
				</aor:FOR-ObjectVariable>
				<aor:FOR-ObjectVariable variable="actionChoice" objectType="ActionChoice">
					<aor:ObjectIdRef language="Java JavaScript"><![CDATA[(this.police === null)? 0 : this.police.selectFittingAction(this.police.getLastInputChoice())]]></aor:ObjectIdRef>
				</aor:FOR-ObjectVariable>
				<aor:DO>
					<aor:UPDATE-ENV>
						<aor:UpdateObject objectVariable="police">
							<aor:Slot property="nextAction">
								<aor:ObjectValueExpr objectVariable="actionChoice" />
							</aor:Slot>
							<aor:Slot property="needsActionCalculation" value="false" />
						</aor:UpdateObject>
					</aor:UPDATE-ENV>
				</aor:DO>
			</aor:EnvironmentRule>
			<!-- =================================================== -->
		</EnvironmentRules>
		<!-- =================================================== -->
	</SimulationModel>
	<!-- =================================================== -->
	<InitialState>
		<Agent type="Police" name="Henk" id="1" objectVariable="police">
			<aor:Slot property="character" value="police"></aor:Slot>
			<aor:Slot property="characterType">
				<aor:GlobalVariableValueExpr variable="USE_INPUT" />
			</aor:Slot>
			<aor:Slot property="personalityStrategy" value="ConflictStrategy.COLLABORATING"></aor:Slot>
			<aor:Slot property="activePursuitStrategy" value="ConflictStrategy.AVOIDING"></aor:Slot>
			<aor:Slot property="receiverID">
				<aor:GlobalVariableValueExpr variable="JUVENILE_ID" />
			</aor:Slot>
			
		</Agent>
		<Agent type="Juvenile" name="Harry" id="2" objectVariable="juvenile">
			<aor:Slot property="character" value="juvenile"></aor:Slot>
			<aor:Slot property="characterType">
				<aor:GlobalVariableValueExpr variable="FULL_MODEL" />
			</aor:Slot>
			<aor:Slot property="personalityStrategy" value="ConflictStrategy.ACCOMODATING"></aor:Slot>
			<aor:Slot property="activePursuitStrategy" value="ConflictStrategy.COMPETITIVE"></aor:Slot>
			<aor:Slot property="receiverID">
				<aor:GlobalVariableValueExpr variable="POLICE_ID" />
			</aor:Slot>
			
		</Agent>
		<!-- =================================================== -->
		<!-- ============== Actions Juvenile =================== -->
		
		<!-- ============== Neutral Juvenile =================== -->
		<aor:Object type="ActionChoice" name="jAction_1" id="21">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="We zullen zo weg gaan."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_2" id="22">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="Ja, natuurlijk."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_3" id="23">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="Wat is het probleem meneer?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="0"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_4" id="24">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Hebben jullie niet iets beters te doen? Ga boeven vangen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		
		<!-- ============== Positive Juvenile =================== -->
		<aor:Object type="ActionChoice" name="jAction_5" id="25">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="We zullen zo weg zijn en jullie zullen niks meer van ons horen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_6" id="26">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="We zullen het niet meer doen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="0"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_7" id="27">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="We zullen de schade betalen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_8" id="28">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Jullie moeten toch ook wat te doen hebben tijdens het werk."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		
		<!-- ============== Negative Juvenile =================== -->
		<aor:Object type="ActionChoice" name="jAction_9" id="29">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="Begint weg te rennen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_10" id="30">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="'Hij was het!' Wijst een persoon in de eigen groep aan."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_11" id="31">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="Als je nu weg gaat zullen we je niet in elkaar slaan."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="jAction_12" id="32">
			<aor:Slot property="character" value="juvenile" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Trek mes. 'Laat ons met rust of ik steek je neer!'"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>		
		
		
		<!-- ============== Actions Police ==================== -->
		
		<!-- ============== Neutral Police ==================== -->
		<aor:Object type="ActionChoice" name="pAction_1" id="81">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="Kunnen jullie niet ergens anders heen gaan?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="10"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_2" id="82">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="Kunnen we jullie ergens mee helpen?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="10"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_3" id="83">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="Is het clubhuis niet een betere plek voor jullie?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="0"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_4" id="84">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Horen jullie niet op school te zitten?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="0"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-20"></aor:Slot> 
		</aor:Object>
		
		<!-- ============== mildy Positive Police ==================== -->
		<aor:Object type="ActionChoice" name="pAction_5" id="85">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="Moeten we later terugkomen om te controleren of jullie weg zijn?"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="25"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
			<aor:Object type="ActionChoice" name="pAction_6" id="86">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="We zijn gestuurd omdat er klachten zijn."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="25"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="0"></aor:Slot> 
		</aor:Object>
		
		<!-- ============== mildy Negative Police ==================== -->
		<aor:Object type="ActionChoice" name="pAction_7" id="87">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="We willen jullie vriendelijk vragen te stoppen."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-25"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="0"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_8" id="88">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Linker Hand op handboeien, rechter op pistool. 'Wat gaan jullie doen?'"></aor:Slot>
			<aor:Slot property="conversationType" value="non-verbal"></aor:Slot>
			<aor:Slot property="mood" value="-25"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>

		<!-- ============== Positive Police ==================== -->
		<aor:Object type="ActionChoice" name="pAction_9" id="89">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="We houden het bij een waarschuwing"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_10" id="90">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="Jullie kunnen gaan."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_11" id="91">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="Jullie krijgen de rekening nog wel!"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_12" id="92">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Helaas bepalen jullie hier niet de regels."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>

		<!-- ============== Negative Police ==================== -->
		<aor:Object type="ActionChoice" name="pAction_13" id="93">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.AVOIDING" />
			<aor:Slot property="displayText" value="Neemt een paar stappen terug. 'We zullen jullie wat ruimte geven.'"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_14" id="94">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.ACCOMODATING" />
			<aor:Slot property="displayText" value="Meekomen naar het politiebureau jij. De rest kan gaan."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_15" id="95">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COLLABORATING" />
			<aor:Slot property="displayText" value="Stop! We willen niet met jullie vechten."></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="25"></aor:Slot> 
		</aor:Object>
		<aor:Object type="ActionChoice" name="pAction_16" id="96">
			<aor:Slot property="character" value="police" />
			<aor:Slot property="strategy" value="ConflictStrategy.COMPETITIVE" />
			<aor:Slot property="displayText" value="Trek het pistool. 'Handen omhoog!'"></aor:Slot>
			<aor:Slot property="conversationType" value="verbal"></aor:Slot>
			<aor:Slot property="mood" value="-50"></aor:Slot>
			<aor:Slot property="otherMoodBelief" value="-25"></aor:Slot> 
		</aor:Object>
		
		<!-- =================================================== -->
		<aor:CausedEvent occurrenceTime="1" type="StartSim"></aor:CausedEvent>
		<aor:CausedEvent occurrenceTime="1" type="AskInput"></aor:CausedEvent>
		<!-- =================================================== -->
	</InitialState>
	<!-- =================================================== -->
	<UserInterface supportedLanguages="en">
	
	<aor:InitialStateUI>
	<aor:AgentUI agentType="Juvenile">
		<aor:PropertyUI property="characterType" />
		<aor:PropertyUI property="personalityStrategy" />
		<aor:PropertyUI property="activePursuitStrategy" />
	</aor:AgentUI>
	<aor:AgentUI agentType="Police">
		<aor:PropertyUI property="characterType" />
		<aor:PropertyUI property="personalityStrategy" />
		<aor:PropertyUI property="activePursuitStrategy" />
	</aor:AgentUI>
	</aor:InitialStateUI>
	
		<AnimationUI>
			<Views>
				<SpaceView canvasColor="darkgrey">
					<TwoDimensionalSpaceView2D backgroundColor="white" />
				</SpaceView>
				<!-- =================================================== -->
				<ObjectView objectType="Juvenile" displayName="true" >
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					
					<Shape2D x="70%" y="50%">
						<Rectangle texture="juvenile.png" positioning="CenterTop" height="30px" width="30px" />
					</Shape2D>
					<aor:DisplayInfo property="lastMessage" />
				</ObjectView>		
				<!-- =================================================== -->
				<ObjectView objectType="Police" displayName="true">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<Shape2D x="30%" y="50%">
						<Rectangle texture="agent.png" positioning="CenterTop" height="30px" width="30px"></Rectangle>
						
					</Shape2D>
					<aor:DisplayInfo property="lastMessage" />
				</ObjectView>
			</Views>
			<!-- =================================================== -->
			<AgentControlUI waitForUserInput="true" initiallyPlayedAgent="Henk">
				<AgentControlByAgentType type="Police">
					<!-- =================================================== -->
					<TopOutputPanel>
						<OutputFieldGroup>
							<OutputField label="Log:">
								<Source>
									<GlobalVariable name="MessageLogString" />
								</Source>
							</OutputField>
						</OutputFieldGroup>
					</TopOutputPanel>
					<!-- =================================================== -->
					<RightOutputPanel width="1">
						<EventList>
							<InMessageEventView label="Bericht" messageType="Tell" keepInListTime="10">
								<MessageProperty name="senderName" label="Persoon"></MessageProperty>
								<MessageProperty name="content" label="zegt" />
							</InMessageEventView>
						</EventList>
					</RightOutputPanel>
					<!-- =================================================== -->
					
					<MultiChoiceUserActionForm actionRuleParameter="inputChoice"
						actionRule="ProcessInput" positioning="CenterBottom" enabledWhenEventOfType="AskInput">
						<Options>
							<Option value="1" default="true">
								<Text>Concurrerende actie</Text>
							</Option>
							<Option value="2">
								<Text>Ontwijkende actien</Text>
							</Option>
							<Option value="3">
								<Text>Samenwerkende actie</Text>
							</Option>
							<Option value="4">
								<Text>meegaande actie</Text>
							</Option>
						</Options>
					</MultiChoiceUserActionForm>
				</AgentControlByAgentType>
			</AgentControlUI>
		</AnimationUI>
	</UserInterface>
</SimulationScenario>
